<section class="products">
  <header class="toolbar">
    <h1>Products</h1>

    <div class="filters">
      <input
        type="text"
        placeholder="Search products…"
        [ngModel]="search()"
        (ngModelChange)="onSearchChange($event)"
        (keyup.enter)="onSearchEnter()"
      />

      <select [ngModel]="pageSize()" (ngModelChange)="changePageSize($event)">
        <option [ngValue]="6">6 / page</option>
        <option [ngValue]="12">12 / page</option>
        <option [ngValue]="24">24 / page</option>
      </select>
    </div>

    <div class="advanced-filters">
      <input
        type="number"
        placeholder="Min price"
        [ngModel]="priceMin()"
        (ngModelChange)="priceMin.set($event); onFilterChange()"
      />

      <input
        type="number"
        placeholder="Max price"
        [ngModel]="priceMax()"
        (ngModelChange)="priceMax.set($event); onFilterChange()"
      />

      <select
        [ngModel]="availability()"
        (ngModelChange)="availability.set($event); onFilterChange()"
      >
        <option value="all">All</option>
        <option value="in">In stock</option>
        <option value="out">Out of stock</option>
      </select>

      <select
        [ngModel]="category()"
        (ngModelChange)="category.set($event); onFilterChange()"
      >
        <option value="all">All categories</option>
        <option value="Toys">Toys</option>
        <option value="Garden">Garden</option>
        <option value="Music">Music</option>
        <option value="Books">Books</option>
        <option value="Kids">Kids</option>
        <option value="Shoes">Shoes</option>
        <option value="Electronics">Electronics</option>
        <option value="Tools">Tools</option>
        <option value="Computers">Computers</option>
        <option value="Automotive">Automotive</option>
        <option value="Beauty">Beauty</option>
        <option value="Movies">Movies</option>
        <option value="Grocery">Grocery</option>
        <option value="Industrial">Industrial</option>
        <option value="Outdoors">Outdoors</option>
        <option value="Home">Home</option>
        <option value="Health">Health</option>
        <option value="Sports">Sports</option>
        <option value="Jewelery">Jewelery</option>
        <option value="Games">Games</option>
      </select>
    </div>
  </header>

  <div *ngIf="error() as err" class="error">{{ err }}</div>
  <div *ngIf="loading()" class="loading">Loading…</div>

  <div class="grid" *ngIf="!loading() && !error()">
    <article
      class="card"
      *ngFor="let p of pagedItems(); trackBy: trackById"
      [routerLink]="['/products', p.id]"
    >
      <div class="thumb">
        <img *ngIf="p.imageUrl" [src]="p.imageUrl" alt="" />
      </div>
      <div class="body">
        <div class="title" [title]="p.name">{{ p.name }}</div>
        <p class="desc" [title]="p.description">{{ p.description }}</p>
        <div class="meta">
          <span class="price">{{ p.price | currency: 'USD' }}</span>
          <span class="badge" [class.ok]="p.available === true">
            {{ p.available ? 'In stock' : 'Out of stock' }}
          </span>
        </div>
      </div>
    </article>
  </div>

  <footer class="pager" *ngIf="filteredItems().length > 0">
    <button (click)="changePage(-1)" [disabled]="page() === 1">Prev</button>
    <span>Page {{ page() }} / {{ totalPages() }}</span>
    <button (click)="changePage(1)" [disabled]="page() === totalPages()">Next</button>
  </footer>
</section>
